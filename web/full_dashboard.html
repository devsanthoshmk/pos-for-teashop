<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tea Shop - Dashboard</title>
    <link rel="stylesheet" type="text/css" href="/styles/dashboard.css">
    <link rel="stylesheet" type="text/css" href="/styles/nav.css">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">Tea Time</div>
        <ul class="nav-menu">
            <li class="nav-item">
                <a href="#" class="nav-link active">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 8v8m-4-5v5m-4-2v2m-2 4h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z" />
                    </svg>
                    Dashboard
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z" />
                    </svg>
                    POS
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10" />
                    </svg>
                    Inventory
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                    Finances
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <svg class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    Settings
                </a>
            </li>
        </ul>
    </aside>

    <!-- Main Content -->
    <div class="main-content">
        <h1 class="page-title">Sales Dashboard</h1>
        
        <!-- Statistics Cards -->
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-title">Daily Average</div>
                <div class="stat-value">₹1,254</div>
                <div class="stat-trend trend-up">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>
                    </svg>
                    8.2% from last week
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Weekly Average</div>
                <div class="stat-value">₹8,765</div>
                <div class="stat-trend trend-up">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>
                    </svg>
                    5.3% from last month
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Monthly Average</div>
                <div class="stat-value">₹32,450</div>
                <div class="stat-trend trend-down">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 4a.5.5 0 0 1 .5.5v5.793l2.146-2.147a.5.5 0 0 1 .708.708l-3 3a.5.5 0 0 1-.708 0l-3-3a.5.5 0 1 1 .708-.708L7.5 10.293V4.5A.5.5 0 0 1 8 4z"/>
                    </svg>
                    2.1% from last quarter
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Total Sales</div>
                <div class="stat-value">₹389,750</div>
                <div class="stat-trend trend-up">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5z"/>
                    </svg>
                    12.5% from last year
                </div>
            </div>
        </div>
        
        <!-- Charts -->
        <div class="charts-row">
            <div class="chart-container">
                <div class="chart-header">
                    <div class="chart-title">Sales Trend</div>
                    <div class="date-range-filter">
                        <button class="date-option active" data-range="daily">Daily</button>
                        <button class="date-option" data-range="weekly">Weekly</button>
                        <button class="date-option" data-range="monthly">Monthly</button>
                    </div>
                </div>
                <canvas id="salesChart" class="chart-canvas"></canvas>
            </div>
            
            <div class="chart-container">
                <div class="chart-header">
                    <div class="chart-title">Best Selling Products</div>
                </div>
                <canvas id="productsChart" class="chart-canvas"></canvas>
            </div>
        </div>
        
        <!-- Product Performance Table -->
        <div class="products-container">
            <div class="products-header">
                <div class="chart-title">Product Performance</div>
                <button class="export-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5z"/>
                        <path d="M7.646 11.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293V1.5a.5.5 0 0 0-1 0v8.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3z"/>
                    </svg>
                    Export CSV
                </button>
            </div>
            <table class="products-table">
                <thead>
                    <tr>
                        <th>Product</th>
                        <th>Sales</th>
                        <th>Revenue</th>
                        <th>% of Total</th>
                    </tr>
                </thead>
                <tbody id="productTableBody">
                    <!-- Table rows will be populated via JavaScript -->
                </tbody>
            </table>
        </div>

        <div class="data-refresh">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" style="margin-right: 8px;">
                <path d="M11.534 7h3.932a.25.25 0 0 1 .192.41l-1.966 2.36a.25.25 0 0 1-.384 0l-1.966-2.36a.25.25 0 0 1 .192-.41zm-11 2h3.932a.25.25 0 0 0 .192-.41L2.692 6.23a.25.25 0 0 0-.384 0L.342 8.59A.25.25 0 0 0 .534 9z"/>
                <path fill-rule="evenodd" d="M8 3c-1.552 0-2.94.707-3.857 1.818a.5.5 0 1 1-.771-.636A6.002 6.002 0 0 1 13.917 7H12.9A5.002 5.002 0 0 0 8 3zM3.1 9a5.002 5.002 0 0 0 8.757 2.182.5.5 0 1 1 .771.636A6.002 6.002 0 0 1 2.083 9H3.1z"/>
            </svg>
            Last updated: April 28, 2025 at 3:30 PM
        </div>

        <p class="responsive-info">This dashboard is fully responsive and adapts to all screen sizes.</p>
    </div>

    <!-- Include Chart.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <script>
        // Sample CSV data (would be loaded from actual sales.csv file)
        const csvData = `date,time,item,quantity,price,total,subtotal,tax,grandtotal
28-04-2025,15:16,Special Tea,1,25,25,105,6.5,111.5
28-04-2025,15:16,Samosa,1,20,20,105,6.5,111.5
28-04-2025,15:16,Puffs,2,20,40,105,6.5,111.5
27-04-2025,10:22,Coffee,2,20,40,95,5.7,100.7
27-04-2025,10:22,Puffs,1,20,20,95,5.7,100.7
27-04-2025,10:22,Tea,1,15,15,95,5.7,100.7
27-04-2025,10:22,Black Tea,1,20,20,95,5.7,100.7
26-04-2025,14:45,Special Tea,3,25,75,135,8.1,143.1
26-04-2025,14:45,Samosa,3,20,60,135,8.1,143.1
25-04-2025,09:30,Coffee,1,20,20,75,4.5,79.5
25-04-2025,09:30,Black Coffee,1,25,25,75,4.5,79.5
25-04-2025,09:30,Milk,2,15,30,75,4.5,79.5
24-04-2025,16:20,Tea,2,15,30,90,5.4,95.4
24-04-2025,16:20,Puffs,3,20,60,90,5.4,95.4
23-04-2025,11:15,Special Tea,2,25,50,125,7.5,132.5
23-04-2025,11:15,Black Tea,1,20,20,125,7.5,132.5
23-04-2025,11:15,Samosa,2,20,40,125,7.5,132.5
23-04-2025,11:15,Milk,1,15,15,125,7.5,132.5
22-04-2025,13:40,Coffee,3,20,60,150,9,159
22-04-2025,13:40,Puffs,2,20,40,150,9,159
22-04-2025,13:40,Special Tea,2,25,50,150,9,159`;

        // Parse CSV data
        function parseCSV(data) {
            const lines = data.trim().split('\n');
            const headers = lines[0].split(',');
            return lines.slice(1).map(line => {
                const values = line.split(',');
                return headers.reduce((obj, header, index) => {
                    obj[header] = values[index];
                    return obj;
                }, {});
            });
        }

        const salesData = parseCSV(csvData);

        // Calculate statistics
        function calculateStats(data) {
            // Group by date
            const dailySales = {};
            data.forEach(row => {
                const date = row.date;
                if (!dailySales[date]) {
                    dailySales[date] = 0;
                }
                dailySales[date] += parseFloat(row.grandtotal);
            });

            // Get unique dates and sort them
            const dates = Object.keys(dailySales).sort((a, b) => {
                const [dayA, monthA, yearA] = a.split('-');
                const [dayB, monthB, yearB] = b.split('-');
                return new Date(yearA, monthA - 1, dayA) - new Date(yearB, monthB - 1, dayB);
            });

            // Daily sales array for chart
            const dailySalesArray = dates.map(date => ({
                date,
                sales: dailySales[date]
            }));

            // Product performance
            const products = {};
            data.forEach(row => {
                const item = row.item;
                const quantity = parseInt(row.quantity);
                const total = parseFloat(row.total);
                
                if (!products[item]) {
                    products[item] = { quantity: 0, revenue: 0 };
                }
                
                products[item].quantity += quantity;
                products[item].revenue += total;
            });

            const productPerformance = Object.entries(products).map(([name, data]) => ({
                name,
                quantity: data.quantity,
                revenue: data.revenue
            })).sort((a, b) => b.revenue - a.revenue);

            // Calculate total revenue
            const totalRevenue = productPerformance.reduce((sum, product) => sum + product.revenue, 0);
            
            // Add percentage to product performance
            productPerformance.forEach(product => {
                product.percentage = (product.revenue / totalRevenue) * 100;
            });

            return {
                dailySales: dailySalesArray,
                productPerformance
            };
        }

        const stats = calculateStats(salesData);

        // Color palette for charts
        const colors = [
            '#5b3e29', '#8c6e5a', '#e6ccb3', '#f9f3ed', 
            '#d4a373', '#ccd5ae', '#e9edc9', '#fefae0', 
            '#b08968', '#dda15e', '#606c38', '#283618'
        ];

        // Initialize Charts
        document.addEventListener('DOMContentLoaded', function() {
            // Sales Trend Chart
            const salesCtx = document.getElementById('salesChart').getContext('2d');
            const salesChart = new Chart(salesCtx, {
                type: 'line',
                data: {
                    labels: stats.dailySales.map(day => day.date),
                    datasets: [{
                        label: 'Daily Sales (₹)',
                        data: stats.dailySales.map(day => day.sales),
                        backgroundColor: 'rgba(91, 62, 41, 0.2)',
                        borderColor: '#5b3e29',
                        borderWidth: 2,
                        tension: 0.4,
                        pointBackgroundColor: '#5b3e29',
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Sales: ₹${context.raw.toFixed(2)}`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return '₹' + value;
                                }
                            }
                        }
                    }
                }
            });

            // Best Selling Products Chart
            const productsCtx = document.getElementById('productsChart').getContext('2d');
            const productsChart = new Chart(productsCtx, {
                type: 'doughnut',
                data: {
                    labels: stats.productPerformance.map(product => product.name),
                    datasets: [{
                        data: stats.productPerformance.map(product => product.revenue),
                        backgroundColor: colors.slice(0, stats.productPerformance.length),
                        borderWidth: 1
                    }]



                    
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                font: {
                                    size: 12
                                },
                                padding: 15
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const label = context.label || '';
                                    const value = context.raw || 0;
                                    const percentage = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const calculatedPercentage = ((value / percentage) * 100).toFixed(1);
                                    return `${label}: ₹${value} (${calculatedPercentage}%)`;
                                }
                            }
                        }
                    },
                    cutout: '65%'
                }
            });

            // Populate Product Table
            const productTableBody = document.getElementById('productTableBody');
            stats.productPerformance.forEach((product, index) => {
                const row = document.createElement('tr');
                
                const nameCell = document.createElement('td');
                const nameContainer = document.createElement('div');
                nameContainer.className = 'product-name';
                
                const colorDot = document.createElement('div');
                colorDot.className = 'product-color';
                colorDot.style.backgroundColor = colors[index % colors.length];
                
                nameContainer.appendChild(colorDot);
                nameContainer.appendChild(document.createTextNode(product.name));
                nameCell.appendChild(nameContainer);
                
                const quantityCell = document.createElement('td');
                quantityCell.textContent = product.quantity;
                
                const revenueCell = document.createElement('td');
                revenueCell.textContent = `₹${product.revenue.toFixed(2)}`;
                
                const percentageCell = document.createElement('td');
                
                const percentageContainer = document.createElement('div');
                percentageContainer.style.display = 'flex';
                percentageContainer.style.alignItems = 'center';
                percentageContainer.style.gap = '10px';
                
                const percentageText = document.createElement('span');
                percentageText.textContent = `${product.percentage.toFixed(1)}%`;
                percentageText.style.width = '50px';
                
                const progressBar = document.createElement('div');
                progressBar.className = 'progress-bar';
                
                const progressFill = document.createElement('div');
                progressFill.className = 'progress-fill';
                progressFill.style.width = `${product.percentage}%`;
                progressFill.style.backgroundColor = colors[index % colors.length];
                
                progressBar.appendChild(progressFill);
                
                percentageContainer.appendChild(percentageText);
                percentageContainer.appendChild(progressBar);
                
                percentageCell.appendChild(percentageContainer);
                
                row.appendChild(nameCell);
                row.appendChild(quantityCell);
                row.appendChild(revenueCell);
                row.appendChild(percentageCell);
                
                productTableBody.appendChild(row);
            });

            // Date range filter functionality
            const dateOptions = document.querySelectorAll('.date-option');
            dateOptions.forEach(option => {
                option.addEventListener('click', function() {
                    // Remove active class from all options
                    dateOptions.forEach(opt => opt.classList.remove('active'));
                    
                    // Add active class to clicked option
                    this.classList.add('active');
                    
                    // Update chart based on selected range
                    const range = this.getAttribute('data-range');
                    updateChartByRange(range);
                });
            });

            function updateChartByRange(range) {
                // In a real application, this would filter data based on the range
                // For demo, we'll just update the chart title
                const chartTitle = document.querySelector('.chart-container .chart-title');
                chartTitle.textContent = `Sales Trend (${range.charAt(0).toUpperCase() + range.slice(1)})`;
                
                // Mock data transformation (in real app, would actually filter data)
                // Here we're just making visual changes to simulate functionality
                if (range === 'weekly') {
                    salesChart.data.labels = ['Week 1', 'Week 2', 'Week 3', 'Week 4'];
                    salesChart.data.datasets[0].data = [350, 425, 380, 450];
                } else if (range === 'monthly') {
                    salesChart.data.labels = ['Jan', 'Feb', 'Mar', 'Apr'];
                    salesChart.data.datasets[0].data = [1200, 1350, 1450, 1550];
                } else {
                    // Reset to daily
                    salesChart.data.labels = stats.dailySales.map(day => day.date);
                    salesChart.data.datasets[0].data = stats.dailySales.map(day => day.sales);
                }
                
                salesChart.update();
            }

            // Export button functionality
            const exportBtn = document.querySelector('.export-btn');
            exportBtn.addEventListener('click', function() {
                // In a real application, this would generate and download a CSV file
                alert('This would download a CSV file of the product performance data in a real application.');
            });
        });
    </script>
</body>
</html>